BufferAssignment:
allocation 0: size 268435456, parameter 0, shape |f32[32,512,4096]| at ShapeIndex {}:
 value: <0 param @0> (size=268435456,offset=0): f32[32,512,4096]{2,1,0:T(8,128)}
allocation 1: size 1073741824, output shape is |f32[128,512,4096]|, maybe-live-out:
 value: <2 copy.1 @0> (size=1073741824,offset=0): f32[128,512,4096]{2,1,0:T(8,128)}
allocation 2: size 0, color 1, preallocated-temp:
allocation 3: size 1073741824, preallocated-temp:
 value: <1 all-gather.5 @0> (size=1073741824,offset=0): f32[128,512,4096]{2,1,0:T(8,128)}

Total bytes used: 2415919104 (2.25GiB)

Used values:
<0 param @0>
 positions:
  param
 uses:
  all-gather.5, operand 0
 from instruction: %param = f32[32,512,4096]{2,1,0:T(8,128)} parameter(0), sharding={devices=[4,1,1]0,1,2,3}
<1 all-gather.5 @0>
 positions:
  all-gather.5
 uses:
  copy.1, operand 0
 from instruction: %all-gather.5 = f32[128,512,4096]{2,1,0:T(8,128)} all-gather(f32[32,512,4096]{2,1,0:T(8,128)} %param), channel_id=1, replica_groups={{0,1,2,3}}, dimensions={0}, use_global_device_ids=true, frontend_attributes={async_collective_name="all-gather-start"}, backend_config={"flag_configs":[],"barrier_config":{"barrier_type":"CUSTOM","id":"0"},"scoped_memory_configs":[],"used_scoped_memory_configs":[]}
<2 copy.1 @0>
 positions:
  copy.1
 uses:
 from instruction: %copy.1 = f32[128,512,4096]{2,1,0:T(8,128)} copy(f32[128,512,4096]{2,1,0:T(8,128)} %all-gather.5)


HloLiveRange (max 3):
  InstructionSequence:
    0:param
    1:all-gather.5
    2:copy.1
  BufferLiveRange:
    param{}:0-3
    all-gather.5{}:1-2
    copy.1{}:2-3
  Live ranges at 2 (peak):
    param: 268435456 bytes
    all-gather.5: 1073741824 bytes
    copy.1: 1073741824 bytes
